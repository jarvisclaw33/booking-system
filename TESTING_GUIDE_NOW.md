# üß™ MULTI-STAFF TESTING GUIDE ‚Äî START HERE\n\n**Dev Server:** http://localhost:3006  \n**Status:** RUNNING NOW ‚úÖ\n\n---\n\n## üìã QUICK TEST PLAN (2-3 hours)\n\n### Phase 1: Database Setup (30 min)\n### Phase 2: API Testing (30 min)\n### Phase 3: UI Components (60 min)\n### Phase 4: End-to-End (30 min)\n\n---\n\n## PHASE 1: Database Setup (30 min)\n\n### Step 1.1: Verify Database Connection\n\n```bash\n# Check Supabase connection\ncurl -X GET \"http://localhost:3006/api/locations\" \\\n  -H \"Content-Type: application/json\"\n\n# Expected: Either empty array [] or list of existing locations\n```\n\n### Step 1.2: Create Test Data (in Supabase Dashboard)\n\nOpen: https://app.supabase.com ‚Üí your project ‚Üí SQL Editor\n\n```sql\n-- 1. Create test organization\nINSERT INTO organizations (name)\nVALUES ('Test Salon')\nRETURNING id;\n\n-- Copy the returned ID and use it below as ORG_UUID\n\n-- 2. Create test location\nINSERT INTO locations (organization_id, name, timezone)\nVALUES ('ORG_UUID', 'Test Salon Berlin', 'Europe/Berlin')\nRETURNING id;\n\n-- Copy the returned ID and use it below as LOC_UUID\n\n-- 3. Create test offering (service)\nINSERT INTO offerings (organization_id, location_id, name, duration_minutes)\nVALUES ('ORG_UUID', 'LOC_UUID', 'Haarschnitt', 30)\nRETURNING id;\n\n-- Copy the returned ID and use it below as OFFER_UUID\n\n-- 4. Create test staff members\nINSERT INTO resources (organization_id, location_id, name, type, capacity, is_active)\nVALUES \n  ('ORG_UUID', 'LOC_UUID', 'Jane (Stylist)', 'staff', 1, true),\n  ('ORG_UUID', 'LOC_UUID', 'John (Barber)', 'staff', 1, true)\nRETURNING id, name;\n\n-- Copy both staff IDs\n\n-- 5. Create schedules for staff (working hours)\nINSERT INTO schedules (resource_id, location_id, day_of_week, start_time, end_time, is_active)\nVALUES \n  ('JANE_UUID', 'LOC_UUID', 0, '09:00:00', '18:00:00', true),  -- Sunday off\n  ('JANE_UUID', 'LOC_UUID', 1, '09:00:00', '18:00:00', true),  -- Monday\n  ('JANE_UUID', 'LOC_UUID', 2, '09:00:00', '18:00:00', true),  -- Tuesday\n  ('JANE_UUID', 'LOC_UUID', 3, '09:00:00', '18:00:00', true),  -- Wednesday\n  ('JANE_UUID', 'LOC_UUID', 4, '09:00:00', '18:00:00', true),  -- Thursday\n  ('JANE_UUID', 'LOC_UUID', 5, '09:00:00', '18:00:00', true),  -- Friday\n  ('JANE_UUID', 'LOC_UUID', 6, '09:00:00', '14:00:00', true),  -- Saturday (half)\n  \n  ('JOHN_UUID', 'LOC_UUID', 0, '10:00:00', '19:00:00', true),  -- Sunday off\n  ('JOHN_UUID', 'LOC_UUID', 1, '10:00:00', '19:00:00', true),  -- Monday\n  ('JOHN_UUID', 'LOC_UUID', 2, '10:00:00', '19:00:00', true),  -- Tuesday\n  ('JOHN_UUID', 'LOC_UUID', 3, '10:00:00', '19:00:00', true),  -- Wednesday\n  ('JOHN_UUID', 'LOC_UUID', 4, '10:00:00', '19:00:00', true),  -- Thursday\n  ('JOHN_UUID', 'LOC_UUID', 5, '10:00:00', '19:00:00', true),  -- Friday\n  ('JOHN_UUID', 'LOC_UUID', 6, '10:00:00', '15:00:00', true)   -- Saturday (half)\n;\n```\n\n**Save these UUIDs for later:**\n```\nORG_UUID = [your-org-id]\nLOC_UUID = [your-location-id]\nOFFER_UUID = [your-offering-id]\nJANE_UUID = [jane-id]\nJOHN_UUID = [john-id]\n```\n\n---\n\n## PHASE 2: API Testing (30 min)\n\n### Test 2.1: Get Individual Staff Availability\n\n```bash\ncurl \"http://localhost:3006/api/availability/enhanced?locationId=LOC_UUID&offeringId=OFFER_UUID&date=2025-02-16&staffId=JANE_UUID\" \\\n  -H \"Content-Type: application/json\"\n```\n\n**Expected Response:**\n```json\n{\n  \"type\": \"individual\",\n  \"date\": \"2025-02-16\",\n  \"staffMember\": {\n    \"staffId\": \"jane-uuid\",\n    \"staffName\": \"Jane (Stylist)\",\n    \"slots\": [\n      { \"startTime\": \"2025-02-16T09:00:00.000Z\", \"endTime\": \"2025-02-16T09:30:00.000Z\", \"available\": true },\n      { \"startTime\": \"2025-02-16T09:30:00.000Z\", \"endTime\": \"2025-02-16T10:00:00.000Z\", \"available\": true }\n      // ... more 30-min slots\n    ],\n    \"availableSlots\": 18,\n    \"totalSlots\": 18,\n    \"utilizationRate\": 0\n  }\n}\n```\n\n‚úÖ **If you see slots**: API is working!\n\n### Test 2.2: Get Aggregated Availability\n\n```bash\ncurl \"http://localhost:3006/api/availability/enhanced?locationId=LOC_UUID&offeringId=OFFER_UUID&date=2025-02-16&aggregated=true\" \\\n  -H \"Content-Type: application/json\"\n```\n\n**Expected Response:**\n```json\n{\n  \"type\": \"aggregated\",\n  \"aggregated\": {\n    \"date\": \"2025-02-16\",\n    \"totalCapacity\": 2,\n    \"bookedCapacity\": 0,\n    \"availableCapacity\": 2,\n    \"utilizationRate\": 0,\n    \"status\": \"green\",\n    \"peakHours\": [],\n    \"freeSlots\": [\"2025-02-16T09:00Z\", \"2025-02-16T10:00Z\"],\n    \"staffSummary\": [\n      { \"staffId\": \"jane-uuid\", \"staffName\": \"Jane\", \"utilization\": 0 },\n      { \"staffId\": \"john-uuid\", \"staffName\": \"John\", \"utilization\": 0 }\n    ]\n  },\n  \"staffDetails\": [...]\n}\n```\n\n‚úÖ **If you see \"green\" status**: Aggregation works!\n\n### Test 2.3: Create Booking with Staff Assignment\n\n```bash\ncurl -X POST \"http://localhost:3006/api/bookings/enhanced\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"locationId\": \"LOC_UUID\",\n    \"offeringId\": \"OFFER_UUID\",\n    \"resourceId\": \"JANE_UUID\",\n    \"customerName\": \"Test Customer\",\n    \"customerEmail\": \"test@example.com\",\n    \"customerPhone\": \"+49123456789\",\n    \"startTime\": \"2025-02-16T09:00:00Z\",\n    \"endTime\": \"2025-02-16T09:30:00Z\",\n    \"notes\": \"Test booking\"\n  }'\n```\n\n**Expected Response:**\n```json\n{\n  \"id\": \"booking-uuid\",\n  \"organization_id\": \"org-uuid\",\n  \"location_id\": \"loc-uuid\",\n  \"offering_id\": \"offer-uuid\",\n  \"resource_id\": \"jane-uuid\",\n  \"customer_name\": \"Test Customer\",\n  \"customer_email\": \"test@example.com\",\n  \"start_time\": \"2025-02-16T09:00:00Z\",\n  \"end_time\": \"2025-02-16T09:30:00Z\",\n  \"status\": \"confirmed\"\n}\n```\n\n‚úÖ **If you see resource_id**: Staff assignment works!\n\n### Test 2.4: Verify Booking Blocks Availability\n\n```bash\n# Run Test 2.1 again (individual staff availability)\n# Now the 9:00-9:30 slot should show available: false\n```\n\n‚úÖ **If the slot is now blocked**: Conflict detection works!\n\n---\n\n## PHASE 3: UI Components (60 min)\n\n### Setup 3.1: Create Test Page\n\nCreate file: `app/dashboard/test-staff/page.tsx`\n\n```typescript\n'use client'\n\nimport { StaffBookingInterface } from '@/components/StaffBookingInterface'\n\nexport default function TestStaffPage() {\n  // Replace with YOUR UUIDs from Phase 1\n  const ORG_UUID = 'your-org-uuid'\n  const LOC_UUID = 'your-location-uuid'\n  const OFFER_UUID = 'your-offering-uuid'\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 dark:bg-gray-900 p-6\">\n      <StaffBookingInterface\n        locationId={LOC_UUID}\n        offeringId={OFFER_UUID}\n        organizationId={ORG_UUID}\n      />\n    </div>\n  )\n}\n```\n\n### Setup 3.2: Test in Browser\n\n**URL:** http://localhost:3006/dashboard/test-staff\n\n### Test 3.1: Staff Selector\n\n‚úÖ **Check:**\n- [ ] See two buttons: \"Mitarbeiter-Ansicht\" and \"Gesamt-Ansicht\"\n- [ ] See staff member tabs/dropdown\n- [ ] Can click between Jane and John\n- [ ] Shows utilization status (green/orange/red)\n\n### Test 3.2: Dashboard View\n\n- [ ] Click \"Gesamt-Ansicht\"\n- [ ] See aggregated metrics:\n  - [ ] \"Verf√ºgbare Mitarbeiter: 2 / 2\"\n  - [ ] \"Auslastung: 0%\" (or higher if bookings exist)\n  - [ ] Status card shows \"‚úÖ Viel Kapazit√§t verf√ºgbar\"\n  - [ ] Peak hours and free slots listed\n  - [ ] Staff utilization bars (should be blue/empty)\n\n### Test 3.3: Calendar View\n\n- [ ] Click \"Mitarbeiter-Ansicht\"\n- [ ] See calendar with time slots\n- [ ] Table shows:\n  - [ ] Time column (09:00, 09:30, 10:00, ...)\n  - [ ] Jane column (should show green ‚úì)\n  - [ ] John column (should show green ‚úì)\n- [ ] Date navigation works (previous/next day)\n- [ ] Slots show \"‚úì Frei\" or \"‚úó Gebucht\"\n\n### Test 3.4: Booking Form\n\n- [ ] Click on a green slot (should be available)\n- [ ] Booking form appears:\n  - [ ] Shows selected time\n  - [ ] Shows selected staff member\n  - [ ] Has fields: Name, Email, Phone, Notes\n- [ ] Try booking:\n  - [ ] Fill in name + email\n  - [ ] Click \"Buchung best√§tigen\"\n  - [ ] See success message (toast)\n  - [ ] Slot changes to red ‚úó\n\n### Test 3.5: Multi-Staff Verification\n\n- [ ] Switch to different staff member\n- [ ] Previously booked slot should still be RED (that staff is blocked)\n- [ ] Try to book different staff at same time ‚Üí should work\n- [ ] Book both staff members at 9:00 ‚Üí both should show booked\n\n---\n\n## PHASE 4: End-to-End Test (30 min)\n\n### Test 4.1: Repeat with Different Services\n\n**Create second offering:**\n```sql\nINSERT INTO offerings (organization_id, location_id, name, duration_minutes)\nVALUES ('ORG_UUID', 'LOC_UUID', 'F√∂hnen', 15)  -- 15-min service\nRETURNING id;\n```\n\n- [ ] Switch service in your test page\n- [ ] Verify slots now show 15-min intervals (not 30)\n- [ ] Booking logic works for both\n\n### Test 4.2: Conflict Detection\n\n- [ ] Try booking Jane at 9:00-9:15\n- [ ] Then try booking Jane at 9:10-9:25 (overlapping)\n- [ ] Should get error: \"Time slot not available\"\n\n### Test 4.3: Mobile Responsive\n\n- [ ] Open DevTools (Cmd+Shift+I on Mac)\n- [ ] Toggle device toolbar (Cmd+Shift+M)\n- [ ] Test on iPhone SE (375px width)\n  - [ ] Staff buttons scroll horizontally\n  - [ ] Calendar table scrolls horizontally\n  - [ ] Form fields are full width\n  - [ ] All buttons clickable\n\n### Test 4.4: Dark Mode\n\n- [ ] Toggle dark mode in browser\n- [ ] All components should adapt:\n  - [ ] Text readable\n  - [ ] Status colors visible\n  - [ ] Forms usable\n\n---\n\n## ‚úÖ SUCCESS CRITERIA\n\n**All Phases Passed = System Ready**\n\n| Phase | Criteria | Status |\n|-------|----------|--------|\n| **1** | Test data created, UUIDs saved | [ ] |\n| **2** | All 4 API tests return expected data | [ ] |\n| **3** | UI components render and respond | [ ] |\n| **4** | E2E booking flow works | [ ] |\n\n---\n\n## üêõ Troubleshooting\n\n### \"404 endpoints not found\"\n‚Üí Dev server is running at localhost:3006 (not 3001)\n\n### \"No staff members found\"\n‚Üí Verify schedules exist in database (day_of_week must match today)\n\n### \"No slots showing\"\n‚Üí Check:\n- [ ] Schedules created for correct day of week\n- [ ] start_time < end_time\n- [ ] Offering duration set correctly\n\n### \"Booking creation fails\"\n‚Üí Check:\n- [ ] All UUIDs are correct\n- [ ] Location matches offering\n- [ ] Staff member belongs to location\n- [ ] Time is within working hours\n\n### \"Mobile layout broken\"\n‚Üí Check:\n- [ ] TailwindCSS compiled (`npm run build`)\n- [ ] Responsive classes applied\n- [ ] Browser cache cleared (Cmd+Shift+Delete)\n\n---\n\n## üìä Expected Results Summary\n\n**After completing all phases:**\n\n‚úÖ 2 staff members can accept bookings  \n‚úÖ Can view individual or aggregated availability  \n‚úÖ Can book individual staff members  \n‚úÖ Conflicts are prevented  \n‚úÖ Works on mobile  \n‚úÖ Dark mode works  \n‚úÖ UI is responsive and German  \n\n**System is ready for customer testing!**\n\n---\n\n## üìù Notes for Testing\n\nSave this format for quick testing:\n\n```\n=== TEST SESSION ===\nDate: 2026-02-16\nOrg: ORG_UUID\nLoc: LOC_UUID\nOffer: OFFER_UUID\nJane: JANE_UUID\nJohn: JOHN_UUID\n\nAPI Tests: [‚úÖ/‚ùå] Pass rate: X/4\nUI Tests: [‚úÖ/‚ùå] Pass rate: X/5\nE2E Tests: [‚úÖ/‚ùå] Pass rate: X/4\n\nNotes:\n[any issues found]\n```\n\n---\n\n**Ready to start? Begin with Phase 1 ‚Üí Phase 2 ‚Üí Phase 3 ‚Üí Phase 4**\n"
